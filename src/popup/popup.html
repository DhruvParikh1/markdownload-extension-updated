<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MarkSnip</title>
  <link rel="stylesheet" href="lib/codemirror.css">
  <link rel="stylesheet" href="lib/xq-dark.css">
  <link rel="stylesheet" href="lib/xq-light.css">
  <link rel="stylesheet" href="popup.css">
</head>

<body>
  <!-- Loading Spinner -->
  <div id="spinner" class="loading-state">
    <div class="spinner-ring"></div>
    <p class="loading-text">Processing page...</p>
  </div>

  <!-- Main Container -->
  <div id="container" class="container">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <h1 class="app-title">MarkSnip</h1>
        <p class="app-subtitle">Convert to Markdown</p>
      </div>
      <div class="header-actions">
        <a href="#" id="batchProcess" class="icon-btn" title="Batch Processing">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <path d="M9 15h6"/>
          </svg>
        </a>
        <a href="/options/options.html" id="options" target="_blank" class="icon-btn" title="Settings">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v6m0 6v6m8.66-15L17 7.34M7 17l-3.66 3.66M23 12h-6m-6 0H1m20.66 8.66L17 16.34M7 7 3.34 3.34"/>
          </svg>
        </a>
      </div>
    </header>

    <!-- Quick Settings -->
    <section class="settings-panel">
      <div class="setting-row">
        <label class="setting-label">
          <input type="checkbox" id="downloadImages" class="setting-checkbox">
          <span class="checkbox-custom"></span>
          <span class="setting-text">Download Images</span>
        </label>
      </div>
      
      <div class="setting-row">
        <label class="setting-label">
          <input type="checkbox" id="includeTemplate" class="setting-checkbox">
          <span class="checkbox-custom"></span>
          <span class="setting-text">Include Template</span>
        </label>
      </div>

      <div class="setting-row" id="clipOption">
        <span class="setting-text-static">Content:</span>
        <div class="segmented-control">
          <button class="segment" id="selected" data-value="selection">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
              <path d="M9 2v2H7c-1.1 0-2 .9-2 2v2H3c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2v-2h2c1.1 0 2-.9 2-2v-2h2c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-2V2c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2zm10 4v8h-2v-2c0-1.1-.9-2-2-2h-2V6h6zM7 10h8v8H7v-8z"/>
            </svg>
            Selection
          </button>
          <button class="segment" id="document" data-value="document">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"/>
            </svg>
            Document
          </button>
        </div>
      </div>
    </section>

    <!-- Title Input -->
    <section class="title-section">
      <label for="title" class="input-label">Title</label>
      <input type="text" id="title" class="title-input" placeholder="Document title...">
    </section>

    <!-- Editor Section -->
    <section class="editor-section">
      <div class="editor-header">
        <span class="editor-label">Markdown Preview</span>
        <div class="editor-actions">
          <button id="copySelection" class="editor-btn" style="display: none;">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
            </svg>
            Copy Selection
          </button>
          <button id="copy" class="editor-btn">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
            </svg>
            Copy All
          </button>
        </div>
      </div>
      <textarea id="md" class="markdown-textarea"></textarea>
    </section>

    <!-- Action Buttons -->
    <section class="action-section">
      <button id="downloadSelection" class="btn btn-secondary" style="display: none;">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7 10 12 15 17 10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
        Download Selection
      </button>
      <button id="sendToObsidian" class="btn btn-secondary">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2L2 7l10 5 10-5-10-5z"/>
          <path d="M2 17l10 5 10-5"/>
          <path d="M2 12l10 5 10-5"/>
        </svg>
        Send to Obsidian
      </button>
      <button id="download" class="btn btn-primary">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7 10 12 15 17 10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
        Download
      </button>
    </section>
  </div>

  <!-- Batch Processing Container -->
  <div id="batchContainer" class="batch-container">
    <header class="batch-header">
      <h2 class="batch-title">Batch Processing</h2>
      <button id="cancelBatch" class="icon-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </header>
    
    <div class="batch-content">
      <label for="urlList" class="input-label">URLs (one per line)</label>
      <textarea id="urlList" class="url-textarea" placeholder="https://example.com/page1&#10;https://example.com/page2&#10;&#10;Or use markdown links:&#10;[Page Title](https://example.com)"></textarea>
      
      <div id="progressContainer" class="progress-container" style="display: none;">
        <div class="progress-header">
          <span id="progressStatus" class="progress-label">Processing...</span>
          <span id="progressCount" class="progress-count">0/0</span>
        </div>
        <div class="progress-bar-bg">
          <div id="progressBar" class="progress-bar"></div>
        </div>
        <p id="currentUrl" class="current-url"></p>
      </div>
      
      <section class="action-section" style="padding-top: 0;"></section>
        <button id="convertUrls" class="btn btn-primary btn-block">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="16 18 22 12 16 6"/>
            <polyline points="8 6 2 12 8 18"/>
          </svg>
          Convert All URLs
        </button>
      </section>
    </div>
  </div>

  <script type="application/javascript" src="../browser-polyfill.min.js"></script>
  <script type="application/javascript" src="lib/codemirror.js"></script>
  <script type="application/javascript" src="lib/modes/markdown/markdown.js"></script>
  <script type="application/javascript" src="popup.js"></script>
</body>
</html>